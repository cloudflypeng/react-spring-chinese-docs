æ¦‚è¿°

```JavaScript
import { useTransition, animated } from 'react-spring'
```


ä¸€ä¸ªåŠ¨ç”»è½¬æ¢ç»„ã€‚ ç»™å®ƒä½ çš„itemså’Œç”Ÿå‘½å‘¨æœŸã€‚ æ¯å½“æ·»åŠ æˆ–åˆ é™¤é¡¹ç›®æ—¶ï¼Œå®ƒéƒ½ä¼šä¸ºè¿™äº›æ›´æ”¹è®¾ç½®åŠ¨ç”»ã€‚

### æ‚¨å¯ä»¥è½¬æ¢æ•°ç»„

```JavaScript
function TransitionArray() {
  const [items, setItems] = useState(NUM_TRANS)

  const transitions = useTransition(items, {
    from: { opacity: 0 },
    enter: { opacity: 1 },
    leave: { opacity: 0 },
    delay: 200,
    config: config.molasses,
    onRest: () => setItems([]),
  })

  useEffect(() => {
    if (items.length === 0) {
      setTimeout(() => {
        setItems(NUM_TRANS)
      }, 2000)
    }
  }, [items])

  return (
    <div style={{ display: 'flex' }}>
      {transitions(({ opacity }, item) => (
        <animated.div
          style={{
            opacity: opacity.to(item.op),
            transform: opacity
              .to(item.trans)
              .to(y => `translate3d(0,${y}px,0)`),
          }}>
          {item.fig}
        </animated.div>
      ))}
    </div>
  )
}
```


è½¬æ¢å‡½æ•°æ¥å—ä¸€ä¸ªå›è°ƒï¼Œè¯¥å›è°ƒæ¥æ”¶å››ä¸ªå‚æ•°ï¼šåŠ¨ç”»å€¼ã€é¡¹ç›®ã€è½¬æ¢å¯¹è±¡å’Œå…„å¼Ÿä½ç½®ã€‚

å®ƒè¿”å›ä¸€ä¸ª React ç‰‡æ®µï¼Œå…¶ä¸­åŒ…å«å›è°ƒè¿”å›çš„æ¯ä¸ªå…ƒç´ ã€‚ æ­£å¦‚æ‚¨å¯èƒ½å‡è®¾çš„é‚£æ ·ï¼Œç¦»å¼€åŠ¨ç”»ä¸­é—´çš„å…ƒç´ éœ€è¦ä¿æŒæŒ‚è½½ã€‚

æ— è®ºæ‚¨æ˜¯å¦æ˜ç¡®å®šä¹‰ï¼Œç‰‡æ®µä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¿è¯æœ‰ä¸€ä¸ª key propã€‚ Unkeyed å…ƒç´ å°†ä½¿ç”¨å…¶ Transition å¯¹è±¡ä¸­çš„ ctrl.idã€‚

å¯¹äºæ¯ä¸ªå”¯ä¸€çš„é¡¹ç›®é”®ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ª Transition å¯¹è±¡ã€‚ åªæœ‰å½“å®ƒä½œä¸ºè½¬æ¢å›è°ƒçš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’æ—¶ï¼Œæ‰èƒ½è®¿é—®è½¬æ¢å¯¹è±¡ã€‚

```JavaScript
const elems = transition((style, item, t, i) => (
  <a.div style={style}>{t.phase}</a.div>
))
```


## Properties

|Property|Type|Description|
|-|-|-|
|initial|obj/fn|Initial (first time) base values, optional (can be null)|
|from|obj/fn|Base values, optional|
|enter|obj/fn/array(obj)|Styles apply for entering elements|
|update|obj/fn/array(obj)|Styles apply for updating elements (you can update the hook itself with new values)|
|leave|obj/fn/array(obj)|Styles apply for leaving elements|
|trail|number|Delay in ms before the animation starts, adds up for each enter/update and leave|
|reset|bool/fn|Prefers theÂ `initial`Â prop over theÂ `from`Â prop.|
|keys|array/function|SeeÂ keysÂ for more information|
|key|single item|Only use if you're passing a single item toÂ `useTransition`Â seeÂ keysÂ for more information|
|expires|bool/number|Lets you control when removed items are unmounted (after theirÂ `leave`Â animation has finished) seeÂ expiresÂ for more information|
|sort|fn|Useful shortcut for slicing and sorting your items array before passing it to theÂ `useTransition`Â hook|
|exitBeforeEnter|bool|Ensures any items leaving animate out before the new items animate in|

keys
æ¯ä¸ª Transition å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„é”®æ¥æ ‡è¯†å®ƒã€‚ æ‚¨å¯ä»¥é€‰æ‹©å®šä¹‰æ˜¾å¼é”®æˆ–è®©â€œé¡¹ç›®â€ï¼ˆTransition å¯¹è±¡è¡¨ç¤ºçš„å€¼ï¼‰æˆä¸ºå®ƒè‡ªå·±çš„é”®ã€‚

è¦å®šä¹‰æ˜¾å¼é”®ï¼Œæ‚¨å¿…é¡»åœ¨ useTransition é“å…·ä¸­å®šä¹‰ keys propsã€‚ ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨ items æ•°ç»„æ—¶ï¼Œæ–°çš„ keys å±æ€§å¯ä»¥æ˜¯ï¼š

ä¸€ç»„é”®
æˆ–è€…ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œå®ƒä¸ºç»™å®ƒçš„ä»»ä½•é¡¹ç›®è¿”å›ä¸€ä¸ªé”®ã€‚

```JavaScript
useTransition(items, {
  // Using a function
  keys: item => item.key,
  // Using an array created by lodash.map
  keys: _.map(items, 'key'),
})
```


âš ï¸ å¯¹äºä¸å¯å˜å¯¹è±¡çš„ä»»ä½•é¡¹ç›®ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æ˜¾å¼é”®ã€‚

å¯¹å¯å˜å¯¹è±¡ä½¿ç”¨æ˜¾å¼é”®æ˜¯ä¸å¿…è¦çš„ã€‚ ğŸ¥³

å¦‚æœæ‚¨å°†å•ä¸ªé¡¹ç›®ä¼ é€’ç»™ useTransitionï¼Œåˆ™å¯ä»¥é€‰æ‹©å°†å•ä¸ªé”®ä½œä¸º key prop ä¼ é€’ã€‚

```JavaScript
useTransition(item, {
  key: item.key,
})

```


#### è¿‡æœŸ(expires)
```JavaScript
expires å±æ€§è®©æ‚¨å¯ä»¥æ§åˆ¶ä½•æ—¶å¸è½½å·²ç§»é™¤çš„é¡¹ç›®ï¼ˆåœ¨ç¦»å¼€åŠ¨ç”»å®Œæˆåï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¸è½½è¢«æ¨è¿Ÿåˆ°ä¸‹ä¸€æ¬¡æ¸²æŸ“æˆ–ç›´åˆ°æ‰€æœ‰è½¬æ¢éƒ½åœæ­¢ã€‚

å½“ true æˆ– <= 0 æ—¶ï¼Œä½¿ç”¨é»˜è®¤è¡Œä¸ºã€‚

å¦‚æœä¸º falseï¼Œåˆ™æ°¸è¿œä¸ä¼šå¸è½½ç‰©å“ã€‚

å½“ > 0 æ—¶ï¼Œå¦‚æœè°ƒç”¨ useTransition çš„ç»„ä»¶åœ¨é¡¹ç›®çš„ç¦»å¼€åŠ¨ç”»å®Œæˆåæ²¡æœ‰è‡ªè¡Œé‡æ–°æ¸²æŸ“ï¼Œåˆ™åœ¨ setTimeout è°ƒç”¨ä¸­ä½¿ç”¨æ­¤ prop æ¥å¼ºåˆ¶é‡æ–°æ¸²æŸ“ã€‚

æœ€åï¼Œ expires å±æ€§å¯ä»¥æ˜¯ä¸€ä¸ªæ¥æ”¶é¡¹ç›®å¹¶è¿”å›ä¸Šè¿°ä»»ä½•å€¼çš„å‡½æ•°ã€‚

### æ’åº(Sort)

sort prop æ˜¯ä¸€ä¸ªæ¥å—ä¸¤ä¸ªé¡¹ç›®çš„å‡½æ•°ï¼Œå½“ç¬¬ä¸€ä¸ªé¡¹ç›®åº”è¯¥é¦–å…ˆå‡ºç°æ—¶è¿”å› -1ï¼Œå½“ç¬¬äºŒä¸ªé¡¹ç›®åº”è¯¥å‡ºç°æ—¶è¿”å› 1ã€‚

åœ¨å°† items æ•°ç»„ä¼ é€’ç»™ useTransition é’©å­ä¹‹å‰ï¼Œå®ƒæ˜¯å¯¹å®ƒè¿›è¡Œåˆ‡ç‰‡å’Œæ’åºçš„æœ‰ç”¨å¿«æ·æ–¹å¼ã€‚
```
```JavaScript
// v8
useTransition(items.slice().sort(props.sort), null, props)

// v9
useTransition(items, {
  sort: (a, b) => { ... },
  ...props
})
```


### è¡¥å……è¯´æ˜


### å¤šé˜¶æ®µè¿‡æ¸¡


åˆå§‹/ä»/è¿›å…¥/æ›´æ–°/ç¦»å¼€ç”Ÿå‘½å‘¨æœŸå¯ä»¥æ˜¯å¯¹è±¡ã€æ•°ç»„æˆ–å‡½æ•°ã€‚ å½“æ‚¨æä¾›åŠŸèƒ½æ—¶ï¼Œæ‚¨å¯ä»¥è®¿é—®å„ä¸ªé¡¹ç›®ã€‚ è¯¥å‡½æ•°å…è®¸è¿”å›æ™®é€šå¯¹è±¡ï¼Œæˆ–è€…ä¸€ä¸ªæ•°ç»„æˆ–ä¸€ä¸ªç”¨äºå¤šé˜¶æ®µè½¬æ¢çš„å‡½æ•°ã€‚ å½“æ‚¨æä¾›ä¸€ä¸ªæ™®é€šæ•°ç»„æ—¶ï¼Œæ‚¨è¿˜å¯ä»¥å½¢æˆä¸€ä¸ªåŸºæœ¬çš„å¤šé˜¶æ®µè½¬æ¢ï¼ˆæ— éœ€è®¿é—®è¯¥é¡¹ç›®ï¼‰ã€‚

```JavaScript
useTransition(items, {
  enter: item => [
    { opacity: item.opacity, height: item.height },
    { life: '100%' },
  ],
  leave: item => async (next, cancel) => {
    await next({ life: '0%' })
    await next({ opacity: 0 })
    await next({ height: 0 })
  },
  from: { life: '0%', opacity: 0, height: 0 },
})
```


### åœ¨Routerä¹‹é—´è½¬æ¢

```JavaScript
const location = useLocation()
const transitions = useTransition(location, { ... })
return transitions((props, item) => (
  <animated.div style={props}>
    <Routes location={item}>
      <Route path="/a" element={<A />} />
      <Route path="/b" element={<B />} />
      <Route path="/c" element={<C />} />
    </Routes>
  </animated.div>
))
```




